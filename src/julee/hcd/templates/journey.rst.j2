{% from "base.rst.j2" import page_title, preamble, epilogue, option, option_list, option_multiline, directive_content %}
{# Journey entity RST template #}
{{ page_title(entity.page_title) -}}
{{ preamble(entity.preamble_rst) -}}
.. define-journey:: {{ entity.slug }}
{{ option('persona', entity.persona) -}}
{{ option('intent', entity.intent) -}}
{{ option('outcome', entity.outcome) -}}
{{ option_list('depends-on', entity.depends_on) -}}
{{ option_multiline('preconditions', entity.preconditions) -}}
{{ option_multiline('postconditions', entity.postconditions) -}}
{{ directive_content(entity.goal) }}
{% for step in entity.steps %}
{% if step.step_type.value == 'phase' %}

   .. step-phase:: {{ step.ref }}
{% if step.description %}

{{ step.description | indent(6, first=true) }}
{% endif %}
{% elif step.step_type.value == 'story' %}

   .. step-story:: {{ step.ref }}
{% elif step.step_type.value == 'epic' %}

   .. step-epic:: {{ step.ref }}
{% endif %}
{% endfor %}
{{ epilogue(entity.epilogue_rst) }}
